CMAKE_MINIMUM_REQUIRED(VERSION 2.8)

IF (NOT CMAKE_BUILD_TYPE)
SET(CMAKE_BUILD_TYPE "Debug")
ENDIF ()

PROJECT (zzip C)
include (ExternalProject)
SET (SRC_VER "0.13.65")

OPTION (BUILD_ZLIB "Build dependency ZLIB" OFF)

IF (MSVC)
  SET( ZZIP_LIBRARY ${CMAKE_BINARY_DIR}/zzip/${CMAKE_BUILD_TYPE}/zzip_la.lib)
  SET( ZZIPFSEEKO_LIBRARY ${CMAKE_BINARY_DIR}/zzip/${CMAKE_BUILD_TYPE}/zzipfseeko_la.lib)
  SET( ZZIPMAPPED_LIBRARY ${CMAKE_BINARY_DIR}/zzip/${CMAKE_BUILD_TYPE}/zzipmapped_la.lib)
ELSEIF (LINUX)
  SET( ZZIP_LIBRARY ${CMAKE_BINARY_DIR}/zzip/zzip_la.la)
  SET( ZZIPFSEEKO_LIBRARY ${CMAKE_BINARY_DIR}/zzip/zzipfseeko_la.la)
  SET( ZZIPMAPPED_LIBRARY ${CMAKE_BINARY_DIR}/zzip/zzipmapped_la.la)
ENDIF ()

IF (BUILD_ZLIB)
ADD_SUBDIRECTORY(zlib)
ENDIF ()

ADD_SUBDIRECTORY(zzip)
ADD_SUBDIRECTORY(bins)
ADD_SUBDIRECTORY(test)
ADD_SUBDIRECTORY(zzipwrap)

IF (BUILD_ZLIB)
ADD_DEPENDENCIES( zzip_la zlib )
ADD_DEPENDENCIES( zzipmapped_la zlib )
ADD_DEPENDENCIES( zzipfseeko_la zlib )
ENDIF ()
